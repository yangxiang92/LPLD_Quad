###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.40.1.53790/W32 for ARM     07/Aug/2014  15:34:35 #
# Copyright 1999-2012 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\source\modu #
#                    le\MS5611.c                                              #
#    Command line =  E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\source\modu #
#                    le\MS5611.c -D LPLD_K60 -lCN                             #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\FLASH_M #
#                    INE\List\ -lB E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_ #
#                    V3\iar\FLASH_MINE\List\ -o E:\ShawnDocuments\IAR_WorkSpa #
#                    ce\LPLD_Quad_V3\iar\FLASH_MINE\Obj\ --no_cse             #
#                    --no_unroll --no_inline --no_code_motion --no_tbaa       #
#                    --no_clustering --no_scheduling --debug --endian=little  #
#                    --cpu=Cortex-M4 -e --fpu=None --dlib_config "D:\Program  #
#                    Files\IAR Systems\Embedded Workbench                     #
#                    6.4\arm\INC\c\DLib_Config_Normal.h" -I                   #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\app\ -I E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\ #
#                    iar\..\source\app\Control\ -I                            #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\app\Others\ -I E:\ShawnDocuments\IAR_WorkSpace\LPLD_Q #
#                    uad_V3\iar\..\source\app\Communicate\ -I                 #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\app\Algorithm\ -I E:\ShawnDocuments\IAR_WorkSpace\LPL #
#                    D_Quad_V3\iar\..\source\app\SignalProcess\ -I            #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\module\ -I E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_ #
#                    V3\iar\..\source\module\anbt_dmp\ -I                     #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\module\eMPL\ -I E:\ShawnDocuments\IAR_WorkSpace\LPLD_ #
#                    Quad_V3\iar\..\source\lib\CPU\ -I                        #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\lib\common\ -I E:\ShawnDocuments\IAR_WorkSpace\LPLD_Q #
#                    uad_V3\iar\..\source\lib\LPLD\ -I                        #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\lib\LPLD\HW\ -I E:\ShawnDocuments\IAR_WorkSpace\LPLD_ #
#                    Quad_V3\iar\..\source\lib\LPLD\DEV\ -I                   #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\lib\uCOS-II\Ports\ -I E:\ShawnDocuments\IAR_WorkSpace #
#                    \LPLD_Quad_V3\iar\..\source\lib\uCOS-II\Source\ -I       #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\lib\FatFs\ -I E:\ShawnDocuments\IAR_WorkSpace\LPLD_Qu #
#                    ad_V3\iar\..\source\lib\FatFs\option\ -I                 #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\lib\USB\common\ -I E:\ShawnDocuments\IAR_WorkSpace\LP #
#                    LD_Quad_V3\iar\..\source\lib\USB\driver\ -I              #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\lib\USB\descriptor\ -I E:\ShawnDocuments\IAR_WorkSpac #
#                    e\LPLD_Quad_V3\iar\..\source\lib\USB\class\ -I           #
#                    E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\..\sour #
#                    ce\lib\MyLib\ -On -I "D:\Program Files\IAR               #
#                    Systems\Embedded Workbench 6.4\arm\CMSIS\Include\" -D    #
#                    ARM_MATH_CM4                                             #
#    List file    =  E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\FLASH_M #
#                    INE\List\MS5611.lst                                      #
#    Object file  =  E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\iar\FLASH_M #
#                    INE\Obj\MS5611.o                                         #
#                                                                             #
#                                                                             #
###############################################################################

E:\ShawnDocuments\IAR_WorkSpace\LPLD_Quad_V3\source\module\MS5611.c
      1          /****************************************************************************** 
      2           *       MS5611.c ----- The Driver Function of MS5611(digital pressure sensor)          *
      3           *       (c) Copyright 2012 HUST RENESAS LAB,The Department of CSE, HUST       *
      4           *                        All Rights Reserved                                  *
      5           *Filename             :  MS5611.c                                           *
      6           *Programmer(s)        :  Yang Xiang                                           *
      7           *Description          :                                                       *
      8           *Modification History :                                                       *
      9           *01a 2014/4/2 9:20:03                                                       *
     10           ******************************************************************************/
     11          
     12          #include "MS5611.h"
     13          

   \                                 In section .bss, align 8
     14          MS5611_DataStruct MS5611_data_struct;
   \                     MS5611_data_struct:
   \   00000000                      DS8 80
     15          
     16          /************************************************************************
     17           * Function         InitMS5611                                              
     18           * Usage            To Initialize MS5611(pressure sensor)                           
     19           * Argument         NONE
     20           * Return value     NONE                                                        
     21           * Modification History:                                                  
     22           * 01a 2014/4/2 9:24:51   
     23           *
     24           ************************************************************************/

   \                                 In section .text, align 2, keep-with-next
     25          void InitMS5611 (void) 
     26          {
   \                     InitMS5611:
   \   00000000   0xB500             PUSH     {LR}
   \   00000002   0xB08B             SUB      SP,SP,#+44
     27              I2C_InitTypeDef MS5611_I2C_init_struct = {0};
   \   00000004   0xA801             ADD      R0,SP,#+4
   \   00000006   0x2110             MOVS     R1,#+16
   \   00000008   0x.... 0x....      BL       __aeabi_memclr4
     28              MS5611_I2C_init_struct.I2C_I2Cx = MS5611_I2C_PORT;
   \   0000000C   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   0000000E   0x9001             STR      R0,[SP, #+4]
     29              MS5611_I2C_init_struct.I2C_ICR = MS5611_SCL_400KHZ;
   \   00000010   0x2017             MOVS     R0,#+23
   \   00000012   0xF88D 0x0008      STRB     R0,[SP, #+8]
     30              MS5611_I2C_init_struct.I2C_IntEnable = FALSE;
   \   00000016   0x2000             MOVS     R0,#+0
   \   00000018   0xF88D 0x0009      STRB     R0,[SP, #+9]
     31              MS5611_I2C_init_struct.I2C_SclPin = MS5611_I2C_SCLPIN;
   \   0000001C   0x2046             MOVS     R0,#+70
   \   0000001E   0xF88D 0x000A      STRB     R0,[SP, #+10]
     32              MS5611_I2C_init_struct.I2C_SdaPin = MS5611_I2C_SDAPIN;
   \   00000022   0x2047             MOVS     R0,#+71
   \   00000024   0xF88D 0x000B      STRB     R0,[SP, #+11]
     33              MS5611_I2C_init_struct.I2C_Isr = NULL;
   \   00000028   0x2000             MOVS     R0,#+0
   \   0000002A   0x9004             STR      R0,[SP, #+16]
     34              MS5611_I2C_init_struct.I2C_OpenDrainEnable = TRUE;    
   \   0000002C   0x2001             MOVS     R0,#+1
   \   0000002E   0xF88D 0x000C      STRB     R0,[SP, #+12]
     35              LPLD_I2C_Init(MS5611_I2C_init_struct);
   \   00000032   0xA801             ADD      R0,SP,#+4
   \   00000034   0xC80F             LDM      R0,{R0-R3}
   \   00000036   0x.... 0x....      BL       LPLD_I2C_Init
     36          
     37              GPIO_InitTypeDef MS5611_CSB_pin_init_struct = {0};
   \   0000003A   0xA805             ADD      R0,SP,#+20
   \   0000003C   0x2114             MOVS     R1,#+20
   \   0000003E   0x.... 0x....      BL       __aeabi_memclr4
     38              MS5611_CSB_pin_init_struct.GPIO_PTx = MS5611_CSB_PIN_PORT;
   \   00000042   0x....             LDR.N    R0,??DataTable4_1  ;; 0x400ff080
   \   00000044   0x9005             STR      R0,[SP, #+20]
     39              MS5611_CSB_pin_init_struct.GPIO_Pins = PinNum2GpioPin(MS5611_CSB_PIN_NUM);
   \   00000046   0x200C             MOVS     R0,#+12
   \   00000048   0x.... 0x....      BL       PinNum2GpioPin
   \   0000004C   0x9006             STR      R0,[SP, #+24]
     40              MS5611_CSB_pin_init_struct.GPIO_Dir = DIR_OUTPUT;
   \   0000004E   0x2001             MOVS     R0,#+1
   \   00000050   0xF88D 0x0020      STRB     R0,[SP, #+32]
     41              MS5611_CSB_pin_init_struct.GPIO_Output = OUTPUT_L;
   \   00000054   0x2000             MOVS     R0,#+0
   \   00000056   0xF88D 0x0021      STRB     R0,[SP, #+33]
     42              LPLD_GPIO_Init(MS5611_CSB_pin_init_struct);
   \   0000005A   0xA905             ADD      R1,SP,#+20
   \   0000005C   0xB084             SUB      SP,SP,#+16
   \   0000005E   0x4668             MOV      R0,SP
   \   00000060   0x2214             MOVS     R2,#+20
   \   00000062   0x.... 0x....      BL       __aeabi_memcpy4
   \   00000066   0xBC0F             POP      {R0-R3}
   \   00000068   0x.... 0x....      BL       LPLD_GPIO_Init
     43          
     44              MS5611_WriteCommand(MS5611_RESET);
   \   0000006C   0x201E             MOVS     R0,#+30
   \   0000006E   0x.... 0x....      BL       MS5611_WriteCommand
     45              delayms(10);
   \   00000072   0x200A             MOVS     R0,#+10
   \   00000074   0x.... 0x....      BL       delayms
     46          
     47              MS5611_ReadROM(& MS5611_data_struct);
   \   00000078   0x....             LDR.N    R0,??DataTable4_2
   \   0000007A   0x.... 0x....      BL       MS5611_ReadROM
     48              delayms(10);
   \   0000007E   0x200A             MOVS     R0,#+10
   \   00000080   0x.... 0x....      BL       delayms
     49          
     50              MS5611_ConvADC(MS5611_D1_OSR_4096);
   \   00000084   0x2048             MOVS     R0,#+72
   \   00000086   0x.... 0x....      BL       MS5611_ConvADC
     51              delayms(10);
   \   0000008A   0x200A             MOVS     R0,#+10
   \   0000008C   0x.... 0x....      BL       delayms
     52              MS5611_ReadADC(& MS5611_data_struct, MS5611_ADC_D1);
   \   00000090   0x2101             MOVS     R1,#+1
   \   00000092   0x....             LDR.N    R0,??DataTable4_2
   \   00000094   0x.... 0x....      BL       MS5611_ReadADC
     53          
     54              MS5611_ConvADC(MS5611_D2_OSR_4096);
   \   00000098   0x2058             MOVS     R0,#+88
   \   0000009A   0x.... 0x....      BL       MS5611_ConvADC
     55              delayms(10);
   \   0000009E   0x200A             MOVS     R0,#+10
   \   000000A0   0x.... 0x....      BL       delayms
     56              MS5611_ReadADC(& MS5611_data_struct, MS5611_ADC_D2);
   \   000000A4   0x2102             MOVS     R1,#+2
   \   000000A6   0x....             LDR.N    R0,??DataTable4_2
   \   000000A8   0x.... 0x....      BL       MS5611_ReadADC
     57          
     58              MS5611_Calculate(& MS5611_data_struct);
   \   000000AC   0x....             LDR.N    R0,??DataTable4_2
   \   000000AE   0x.... 0x....      BL       MS5611_Calculate
     59          }		/* -----  end of function InitMS5611  ----- */
   \   000000B2   0xB00B             ADD      SP,SP,#+44
   \   000000B4   0xBD00             POP      {PC}             ;; return
     60          

   \                                 In section .text, align 2, keep-with-next
     61          void MS5611_WriteCommand (uint8 command) 
     62          {
   \                     MS5611_WriteCommand:
   \   00000000   0xB510             PUSH     {R4,LR}
   \   00000002   0x0004             MOVS     R4,R0
     63            //发送从机地址
     64            //I2C产生start信号
     65            LPLD_I2C_Start(MS5611_I2C_PORT);
   \   00000004   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   00000006   0x.... 0x....      BL       LPLD_I2C_Start
     66            //将从机地址写入
     67            LPLD_I2C_WriteByte(MS5611_I2C_PORT, MS5611_ADRESS << 1);
   \   0000000A   0x21EE             MOVS     R1,#+238
   \   0000000C   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   0000000E   0x.... 0x....      BL       LPLD_I2C_WriteByte
     68            LPLD_I2C_WaitAck(MS5611_I2C_PORT, I2C_ACK_ON);
   \   00000012   0x2101             MOVS     R1,#+1
   \   00000014   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   00000016   0x.... 0x....      BL       LPLD_I2C_WaitAck
     69            
     70            //写MMA7660寄存器地址
     71            LPLD_I2C_WriteByte(MS5611_I2C_PORT, command);
   \   0000001A   0x0021             MOVS     R1,R4
   \   0000001C   0xB2C9             UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
   \   0000001E   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   00000020   0x.... 0x....      BL       LPLD_I2C_WriteByte
     72            LPLD_I2C_WaitAck(MS5611_I2C_PORT, I2C_ACK_ON);
   \   00000024   0x2101             MOVS     R1,#+1
   \   00000026   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   00000028   0x.... 0x....      BL       LPLD_I2C_WaitAck
     73          
     74            LPLD_I2C_Stop(MS5611_I2C_PORT);
   \   0000002C   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   0000002E   0x.... 0x....      BL       LPLD_I2C_Stop
     75          
     76            delayus(MS5611_I2C_DELAY_TIME);  
   \   00000032   0x2005             MOVS     R0,#+5
   \   00000034   0x.... 0x....      BL       delayus
     77          }		/* -----  end of function MS5611_SingleWriteReg  ----- */
   \   00000038   0xBD10             POP      {R4,PC}          ;; return
     78          

   \                                 In section .text, align 2, keep-with-next
     79          void MS5611_ReadROM(MS5611_DataStruct * COEFF)
     80          {
   \                     MS5611_ReadROM:
   \   00000000   0xB538             PUSH     {R3-R5,LR}
   \   00000002   0x0004             MOVS     R4,R0
     81              uint8 i = 0;
   \   00000004   0x2500             MOVS     R5,#+0
     82          
     83              for(i = 0; i < 6; i++)
   \   00000006   0x2000             MOVS     R0,#+0
   \   00000008   0x0005             MOVS     R5,R0
   \                     ??MS5611_ReadROM_0:
   \   0000000A   0xB2ED             UXTB     R5,R5            ;; ZeroExt  R5,R5,#+24,#+24
   \   0000000C   0x2D06             CMP      R5,#+6
   \   0000000E   0xD209             BCS.N    ??MS5611_ReadROM_1
     84              {
     85                  COEFF->C[i+1] = MS5611_ReadROM_1(i);
   \   00000010   0x0028             MOVS     R0,R5
   \   00000012   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000014   0x.... 0x....      BL       MS5611_ReadROM_1
   \   00000018   0xB2ED             UXTB     R5,R5            ;; ZeroExt  R5,R5,#+24,#+24
   \   0000001A   0xEB14 0x0145      ADDS     R1,R4,R5, LSL #+1
   \   0000001E   0x8048             STRH     R0,[R1, #+2]
     86              }
   \   00000020   0x1C6D             ADDS     R5,R5,#+1
   \   00000022   0xE7F2             B.N      ??MS5611_ReadROM_0
     87          }
   \                     ??MS5611_ReadROM_1:
   \   00000024   0xBD31             POP      {R0,R4,R5,PC}    ;; return
     88          

   \                                 In section .text, align 2, keep-with-next
     89          uint16 MS5611_ReadROM_1(uint8 rom_num)
     90          {
   \                     MS5611_ReadROM_1:
   \   00000000   0xB538             PUSH     {R3-R5,LR}
   \   00000002   0x0004             MOVS     R4,R0
     91              uint8 buf[2]={0,0};
   \   00000004   0x2000             MOVS     R0,#+0
   \   00000006   0xF8AD 0x0000      STRH     R0,[SP, #+0]
     92              uint16 ret = 0;
   \   0000000A   0x2500             MOVS     R5,#+0
     93              MS5611_WriteCommand(MS5611_PROM_COEFF_1 + rom_num * 2);
   \   0000000C   0xB2E4             UXTB     R4,R4            ;; ZeroExt  R4,R4,#+24,#+24
   \   0000000E   0x0060             LSLS     R0,R4,#+1
   \   00000010   0x30A2             ADDS     R0,R0,#+162
   \   00000012   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000014   0x.... 0x....      BL       MS5611_WriteCommand
     94              MS5611_MultiRead(buf, 2);
   \   00000018   0x2102             MOVS     R1,#+2
   \   0000001A   0xA800             ADD      R0,SP,#+0
   \   0000001C   0x.... 0x....      BL       MS5611_MultiRead
     95              ret = ((uint16)buf[0] << 8) + buf[1];
   \   00000020   0xF89D 0x0000      LDRB     R0,[SP, #+0]
   \   00000024   0x0200             LSLS     R0,R0,#+8
   \   00000026   0xF89D 0x1001      LDRB     R1,[SP, #+1]
   \   0000002A   0xFA50 0xF081      UXTAB    R0,R0,R1
   \   0000002E   0x0005             MOVS     R5,R0
     96              
     97              return ret;
   \   00000030   0x0028             MOVS     R0,R5
   \   00000032   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   00000034   0xBD32             POP      {R1,R4,R5,PC}    ;; return
     98          }
     99          

   \                                 In section .text, align 2, keep-with-next
    100          void MS5611_MultiRead(uint8* buf, uint8 data_num)
    101          {
   \                     MS5611_MultiRead:
   \   00000000   0xB570             PUSH     {R4-R6,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
    102              int i = 0;
   \   00000006   0x2600             MOVS     R6,#+0
    103              //发送从机地址
    104              //I2C产生start信号
    105              LPLD_I2C_Start(MS5611_I2C_PORT);
   \   00000008   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   0000000A   0x.... 0x....      BL       LPLD_I2C_Start
    106              //将从机地址写入
    107              LPLD_I2C_WriteByte(MS5611_I2C_PORT, (MS5611_ADRESS << 1) + 1);
   \   0000000E   0x21EF             MOVS     R1,#+239
   \   00000010   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   00000012   0x.... 0x....      BL       LPLD_I2C_WriteByte
    108              LPLD_I2C_WaitAck(MS5611_I2C_PORT, I2C_ACK_ON);    
   \   00000016   0x2101             MOVS     R1,#+1
   \   00000018   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   0000001A   0x.... 0x....      BL       LPLD_I2C_WaitAck
    109          
    110              //转换主机模式为读
    111              LPLD_I2C_SetMasterWR(MS5611_I2C_PORT, I2C_MRSW);
   \   0000001E   0x2101             MOVS     R1,#+1
   \   00000020   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   00000022   0x.... 0x....      BL       LPLD_I2C_SetMasterWR
    112          
    113              for(i = 0; i < data_num; i++)
   \   00000026   0x2000             MOVS     R0,#+0
   \   00000028   0x0006             MOVS     R6,R0
   \                     ??MS5611_MultiRead_0:
   \   0000002A   0xB2ED             UXTB     R5,R5            ;; ZeroExt  R5,R5,#+24,#+24
   \   0000002C   0x42AE             CMP      R6,R5
   \   0000002E   0xDA21             BGE.N    ??MS5611_MultiRead_1
    114              {
    115                  if(i < (data_num-1))
   \   00000030   0xB2ED             UXTB     R5,R5            ;; ZeroExt  R5,R5,#+24,#+24
   \   00000032   0x1E68             SUBS     R0,R5,#+1
   \   00000034   0x4286             CMP      R6,R0
   \   00000036   0xDA06             BGE.N    ??MS5611_MultiRead_2
    116                  {
    117                      /* Turn on ACK */
    118                      MS5611_I2C_PORT->C1 &= (~I2C_C1_TXAK_MASK);
   \   00000038   0x....             LDR.N    R0,??DataTable4_3  ;; 0x40067002
   \   0000003A   0x7800             LDRB     R0,[R0, #+0]
   \   0000003C   0xF010 0x00F7      ANDS     R0,R0,#0xF7
   \   00000040   0x....             LDR.N    R1,??DataTable4_3  ;; 0x40067002
   \   00000042   0x7008             STRB     R0,[R1, #+0]
   \   00000044   0xE005             B.N      ??MS5611_MultiRead_3
    119                  }
    120                  else
    121                  {
    122                      /* Turn off ACK */
    123                      MS5611_I2C_PORT->C1 |= I2C_C1_TXAK_MASK;  // ACK NO 
   \                     ??MS5611_MultiRead_2:
   \   00000046   0x....             LDR.N    R0,??DataTable4_3  ;; 0x40067002
   \   00000048   0x7800             LDRB     R0,[R0, #+0]
   \   0000004A   0xF050 0x0008      ORRS     R0,R0,#0x8
   \   0000004E   0x....             LDR.N    R1,??DataTable4_3  ;; 0x40067002
   \   00000050   0x7008             STRB     R0,[R1, #+0]
    124                  }
    125          
    126                  //读IIC数据
    127                  if(i == 0)
   \                     ??MS5611_MultiRead_3:
   \   00000052   0x2E00             CMP      R6,#+0
   \   00000054   0xD103             BNE.N    ??MS5611_MultiRead_4
    128                  {
    129                      LPLD_I2C_ReadByte(MS5611_I2C_PORT);
   \   00000056   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   00000058   0x.... 0x....      BL       LPLD_I2C_ReadByte
   \   0000005C   0xE004             B.N      ??MS5611_MultiRead_5
    130                  }
    131                  else
    132                  {
    133                      *buf =LPLD_I2C_ReadByte(MS5611_I2C_PORT);
   \                     ??MS5611_MultiRead_4:
   \   0000005E   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   00000060   0x.... 0x....      BL       LPLD_I2C_ReadByte
   \   00000064   0x7020             STRB     R0,[R4, #+0]
    134                      buf ++;
   \   00000066   0x1C64             ADDS     R4,R4,#+1
    135                  }
    136                  LPLD_I2C_WaitAck(MS5611_I2C_PORT, I2C_ACK_ON);
   \                     ??MS5611_MultiRead_5:
   \   00000068   0x2101             MOVS     R1,#+1
   \   0000006A   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   0000006C   0x.... 0x....      BL       LPLD_I2C_WaitAck
    137              }
   \   00000070   0x1C76             ADDS     R6,R6,#+1
   \   00000072   0xE7DA             B.N      ??MS5611_MultiRead_0
    138              //发送停止信号
    139              LPLD_I2C_Stop(MS5611_I2C_PORT);
   \                     ??MS5611_MultiRead_1:
   \   00000074   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   00000076   0x.... 0x....      BL       LPLD_I2C_Stop
    140              *buf = LPLD_I2C_ReadByte(MS5611_I2C_PORT);
   \   0000007A   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   0000007C   0x.... 0x....      BL       LPLD_I2C_ReadByte
   \   00000080   0x7020             STRB     R0,[R4, #+0]
    141          
    142              LPLD_I2C_Stop(MS5611_I2C_PORT);
   \   00000082   0x....             LDR.N    R0,??DataTable4  ;; 0x40067000
   \   00000084   0x.... 0x....      BL       LPLD_I2C_Stop
    143          
    144              delayus(MS5611_I2C_DELAY_TIME);
   \   00000088   0x2005             MOVS     R0,#+5
   \   0000008A   0x.... 0x....      BL       delayus
    145          }
   \   0000008E   0xBD70             POP      {R4-R6,PC}       ;; return
    146          

   \                                 In section .text, align 2, keep-with-next
    147          void MS5611_ConvADC(uint8 ADC_conv_mode)
    148          {
   \                     MS5611_ConvADC:
   \   00000000   0xB510             PUSH     {R4,LR}
   \   00000002   0x0004             MOVS     R4,R0
    149              MS5611_WriteCommand(ADC_conv_mode);
   \   00000004   0x0020             MOVS     R0,R4
   \   00000006   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000008   0x.... 0x....      BL       MS5611_WriteCommand
    150          }
   \   0000000C   0xBD10             POP      {R4,PC}          ;; return
    151          

   \                                 In section .text, align 2, keep-with-next
    152          void MS5611_ReadADC(MS5611_DataStruct * COEFF, uint8 ADC_sel)
    153          {
   \                     MS5611_ReadADC:
   \   00000000   0xB538             PUSH     {R3-R5,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
    154              uint8 buf[3] = {0};
   \   00000006   0xA800             ADD      R0,SP,#+0
   \   00000008   0x2100             MOVS     R1,#+0
   \   0000000A   0x6001             STR      R1,[R0, #+0]
    155          
    156              MS5611_WriteCommand(MS5611_ADC);
   \   0000000C   0x2000             MOVS     R0,#+0
   \   0000000E   0x.... 0x....      BL       MS5611_WriteCommand
    157              MS5611_MultiRead(buf, 3);
   \   00000012   0x2103             MOVS     R1,#+3
   \   00000014   0xA800             ADD      R0,SP,#+0
   \   00000016   0x.... 0x....      BL       MS5611_MultiRead
    158          
    159              COEFF->D[ADC_sel] = ((uint32)buf[0] << 16) | ((uint32)buf[1] << 8) | ((uint32)buf[2]);
   \   0000001A   0xF89D 0x0000      LDRB     R0,[SP, #+0]
   \   0000001E   0xF89D 0x1001      LDRB     R1,[SP, #+1]
   \   00000022   0x0209             LSLS     R1,R1,#+8
   \   00000024   0xEA51 0x4000      ORRS     R0,R1,R0, LSL #+16
   \   00000028   0xF89D 0x1002      LDRB     R1,[SP, #+2]
   \   0000002C   0x4308             ORRS     R0,R1,R0
   \   0000002E   0xB2ED             UXTB     R5,R5            ;; ZeroExt  R5,R5,#+24,#+24
   \   00000030   0xEB14 0x0185      ADDS     R1,R4,R5, LSL #+2
   \   00000034   0x6108             STR      R0,[R1, #+16]
    160          }
   \   00000036   0xBD31             POP      {R0,R4,R5,PC}    ;; return
    161          

   \                                 In section .text, align 2, keep-with-next
    162          void MS5611_Calculate( MS5611_DataStruct* COEFF )
    163          {
   \                     MS5611_Calculate:
   \   00000000   0xE92D 0x43F0      PUSH     {R4-R9,LR}
   \   00000004   0x0004             MOVS     R4,R0
    164            COEFF->dT = (int32)(COEFF->D[2] - (COEFF->C[5]*POW_2_8));          // dT = D2 - C5*2^8
   \   00000006   0x69A0             LDR      R0,[R4, #+24]
   \   00000008   0x8961             LDRH     R1,[R4, #+10]
   \   0000000A   0xF44F 0x7280      MOV      R2,#+256
   \   0000000E   0xFB02 0x0011      MLS      R0,R2,R1,R0
   \   00000012   0x61E0             STR      R0,[R4, #+28]
    165            COEFF->rTemp = (int32)(2000 + ((int64_t)COEFF->dT*COEFF->C[6])/POW_2_23);   // Temp = 2000 + dT*C6/2^23
   \   00000014   0x69E6             LDR      R6,[R4, #+28]
   \   00000016   0x17F7             ASRS     R7,R6,#+31
   \   00000018   0x89A2             LDRH     R2,[R4, #+12]
   \   0000001A   0x2300             MOVS     R3,#+0
   \   0000001C   0xFBA2 0x0106      UMULL    R0,R1,R2,R6
   \   00000020   0xFB02 0x1107      MLA      R1,R2,R7,R1
   \   00000024   0xFB03 0x1106      MLA      R1,R3,R6,R1
   \   00000028   0xF45F 0x0200      MOVS     R2,#+8388608
   \   0000002C   0x2300             MOVS     R3,#+0
   \   0000002E   0x.... 0x....      BL       __aeabi_ldivmod
   \   00000032   0xF510 0x60FA      ADDS     R0,R0,#+2000
   \   00000036   0x6220             STR      R0,[R4, #+32]
    166          
    167            COEFF->OFF = (uint64_t)((uint64_t)COEFF->C[2]*POW_2_16 + ((uint64_t)COEFF->C[4]*COEFF->dT)/POW_2_7);   // OFF = C2*2^16 + (C4*dT)/2^7
   \   00000038   0x88A5             LDRH     R5,[R4, #+4]
   \   0000003A   0xF45F 0x3680      MOVS     R6,#+65536
   \   0000003E   0x8922             LDRH     R2,[R4, #+8]
   \   00000040   0x2300             MOVS     R3,#+0
   \   00000042   0x69E0             LDR      R0,[R4, #+28]
   \   00000044   0x17C1             ASRS     R1,R0,#+31
   \   00000046   0xFBA0 0x8902      UMULL    R8,R9,R0,R2
   \   0000004A   0xFB00 0x9903      MLA      R9,R0,R3,R9
   \   0000004E   0xFB01 0x9902      MLA      R9,R1,R2,R9
   \   00000052   0xEA5F 0x18D8      LSRS     R8,R8,#+7
   \   00000056   0xEA48 0x6849      ORR      R8,R8,R9, LSL #+25
   \   0000005A   0xEA5F 0x19D9      LSRS     R9,R9,#+7
   \   0000005E   0xFBE6 0x8905      UMLAL    R8,R9,R6,R5
   \   00000062   0xE9C4 0x890A      STRD     R8,R9,[R4, #+40]
    168            COEFF->SENS = (uint64_t)((uint64_t)COEFF->C[1]*POW_2_15 + ((uint64_t)COEFF->C[3]*COEFF->dT)/POW_2_8);  // SENS = C1*2^15 + (C3*dT)/2^8
   \   00000066   0x8865             LDRH     R5,[R4, #+2]
   \   00000068   0xF44F 0x4600      MOV      R6,#+32768
   \   0000006C   0x88E2             LDRH     R2,[R4, #+6]
   \   0000006E   0x2300             MOVS     R3,#+0
   \   00000070   0x69E0             LDR      R0,[R4, #+28]
   \   00000072   0x17C1             ASRS     R1,R0,#+31
   \   00000074   0xFBA0 0x8902      UMULL    R8,R9,R0,R2
   \   00000078   0xFB00 0x9903      MLA      R9,R0,R3,R9
   \   0000007C   0xFB01 0x9902      MLA      R9,R1,R2,R9
   \   00000080   0xEA5F 0x2818      LSRS     R8,R8,#+8
   \   00000084   0xEA48 0x6809      ORR      R8,R8,R9, LSL #+24
   \   00000088   0xEA5F 0x2919      LSRS     R9,R9,#+8
   \   0000008C   0xFBE6 0x8905      UMLAL    R8,R9,R6,R5
   \   00000090   0xE9C4 0x890C      STRD     R8,R9,[R4, #+48]
    169            COEFF->rPress = (uint32)((COEFF->D[1]*COEFF->SENS)/POW_2_21 - COEFF->OFF)/POW_2_15;  // Press = (D1*SENS/2^21 - OFF)/2^15
   \   00000094   0x6960             LDR      R0,[R4, #+20]
   \   00000096   0x2100             MOVS     R1,#+0
   \   00000098   0xE9D4 0x230C      LDRD     R2,R3,[R4, #+48]
   \   0000009C   0xFBA2 0x6700      UMULL    R6,R7,R2,R0
   \   000000A0   0xFB02 0x7701      MLA      R7,R2,R1,R7
   \   000000A4   0xFB03 0x7700      MLA      R7,R3,R0,R7
   \   000000A8   0x0D76             LSRS     R6,R6,#+21
   \   000000AA   0xEA46 0x26C7      ORR      R6,R6,R7, LSL #+11
   \   000000AE   0x0D7F             LSRS     R7,R7,#+21
   \   000000B0   0xE9D4 0x010A      LDRD     R0,R1,[R4, #+40]
   \   000000B4   0x1A30             SUBS     R0,R6,R0
   \   000000B6   0xEB77 0x0101      SBCS     R1,R7,R1
   \   000000BA   0x0BC0             LSRS     R0,R0,#+15
   \   000000BC   0x63A0             STR      R0,[R4, #+56]
    170          
    171            COEFF->Temp  = (float)(COEFF->rTemp/100.0f);
   \   000000BE   0x6A20             LDR      R0,[R4, #+32]
   \   000000C0   0x.... 0x....      BL       __aeabi_i2f
   \   000000C4   0x....             LDR.N    R1,??DataTable4_4  ;; 0x42c80000
   \   000000C6   0x.... 0x....      BL       __aeabi_fdiv
   \   000000CA   0x63E0             STR      R0,[R4, #+60]
    172            COEFF->Press = (float)(COEFF->rPress/100.0f);
   \   000000CC   0x6BA0             LDR      R0,[R4, #+56]
   \   000000CE   0x.... 0x....      BL       __aeabi_i2f
   \   000000D2   0x....             LDR.N    R1,??DataTable4_4  ;; 0x42c80000
   \   000000D4   0x.... 0x....      BL       __aeabi_fdiv
   \   000000D8   0x6420             STR      R0,[R4, #+64]
    173            COEFF->High  = (float)((101333-COEFF->rPress)*9.5238f);
   \   000000DA   0x....             LDR.N    R0,??DataTable4_5  ;; 0x18bd5
   \   000000DC   0x6BA1             LDR      R1,[R4, #+56]
   \   000000DE   0x1A40             SUBS     R0,R0,R1
   \   000000E0   0x.... 0x....      BL       __aeabi_i2f
   \   000000E4   0x....             LDR.N    R1,??DataTable4_6  ;; 0x4118617c
   \   000000E6   0x.... 0x....      BL       __aeabi_fmul
   \   000000EA   0x6460             STR      R0,[R4, #+68]
    174          
    175            COEFF->HighReady = 1;
   \   000000EC   0x2001             MOVS     R0,#+1
   \   000000EE   0xF884 0x0048      STRB     R0,[R4, #+72]
    176          }
   \   000000F2   0xE8BD 0x83F0      POP      {R4-R9,PC}       ;; return
    177          
    178          /*=====================================================================================================*/
    179          /*=====================================================================================================*
    180          **函 : MS5611_Read
    181          **功能 : MS5611 Read
    182          **入 : Baro, ADC_ConvMode
    183          **出 : None
    184          **使用 : MS5611_Read(&Baro, MS5611_D1_OSR_4096);
    185          **=====================================================================================================*/
    186          /*=====================================================================================================*/

   \                                 In section .text, align 2, keep-with-next
    187          void MS5611_Read( MS5611_DataStruct* COEFF, uint8 ADC_ConvMode )
    188          {
   \                     MS5611_Read:
   \   00000000   0xB570             PUSH     {R4-R6,LR}
   \   00000002   0x0004             MOVS     R4,R0
   \   00000004   0x000D             MOVS     R5,R1
    189            uint8 ReadFlag = ERROR;
   \   00000006   0x2600             MOVS     R6,#+0
    190            static MS5611_Status ReadSta = MS5611_ConvInit;
    191          
    192            switch(ReadSta) {
   \   00000008   0x....             LDR.N    R0,??DataTable4_7
   \   0000000A   0x7800             LDRB     R0,[R0, #+0]
   \   0000000C   0x2800             CMP      R0,#+0
   \   0000000E   0xD003             BEQ.N    ??MS5611_Read_0
   \   00000010   0x2802             CMP      R0,#+2
   \   00000012   0xD016             BEQ.N    ??MS5611_Read_1
   \   00000014   0xD308             BCC.N    ??MS5611_Read_2
   \   00000016   0xE021             B.N      ??MS5611_Read_3
    193              case MS5611_ConvInit:
    194                MS5611_ConvADC(ADC_ConvMode);
   \                     ??MS5611_Read_0:
   \   00000018   0x0028             MOVS     R0,R5
   \   0000001A   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000001C   0x.... 0x....      BL       MS5611_ConvADC
    195                ReadSta = MS5611_ConvD1;
   \   00000020   0x....             LDR.N    R0,??DataTable4_7
   \   00000022   0x2101             MOVS     R1,#+1
   \   00000024   0x7001             STRB     R1,[R0, #+0]
    196                break;
   \   00000026   0xE019             B.N      ??MS5611_Read_3
    197              case MS5611_ConvD1:
    198                MS5611_ReadADC(COEFF, MS5611_ADC_D1);
   \                     ??MS5611_Read_2:
   \   00000028   0x2101             MOVS     R1,#+1
   \   0000002A   0x0020             MOVS     R0,R4
   \   0000002C   0x.... 0x....      BL       MS5611_ReadADC
    199                MS5611_ConvADC(ADC_ConvMode | 0x10);
   \   00000030   0xF055 0x0010      ORRS     R0,R5,#0x10
   \   00000034   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000036   0x.... 0x....      BL       MS5611_ConvADC
    200                ReadSta = MS5611_ConvD2;
   \   0000003A   0x....             LDR.N    R0,??DataTable4_7
   \   0000003C   0x2102             MOVS     R1,#+2
   \   0000003E   0x7001             STRB     R1,[R0, #+0]
    201                break;
   \   00000040   0xE00C             B.N      ??MS5611_Read_3
    202              case MS5611_ConvD2:
    203                MS5611_ReadADC(COEFF, MS5611_ADC_D2);
   \                     ??MS5611_Read_1:
   \   00000042   0x2102             MOVS     R1,#+2
   \   00000044   0x0020             MOVS     R0,R4
   \   00000046   0x.... 0x....      BL       MS5611_ReadADC
    204                MS5611_ConvADC(ADC_ConvMode);
   \   0000004A   0x0028             MOVS     R0,R5
   \   0000004C   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   0000004E   0x.... 0x....      BL       MS5611_ConvADC
    205                ReadFlag = SUCCESS;
   \   00000052   0x2001             MOVS     R0,#+1
   \   00000054   0x0006             MOVS     R6,R0
    206                ReadSta = MS5611_ConvD1;
   \   00000056   0x....             LDR.N    R0,??DataTable4_7
   \   00000058   0x2101             MOVS     R1,#+1
   \   0000005A   0x7001             STRB     R1,[R0, #+0]
    207                break;
    208            }
    209          
    210            if(ReadFlag == SUCCESS)
   \                     ??MS5611_Read_3:
   \   0000005C   0xB2F6             UXTB     R6,R6            ;; ZeroExt  R6,R6,#+24,#+24
   \   0000005E   0x2E01             CMP      R6,#+1
   \   00000060   0xD102             BNE.N    ??MS5611_Read_4
    211              MS5611_Calculate(COEFF);
   \   00000062   0x0020             MOVS     R0,R4
   \   00000064   0x.... 0x....      BL       MS5611_Calculate
    212          }
   \                     ??MS5611_Read_4:
   \   00000068   0xBD70             POP      {R4-R6,PC}       ;; return

   \                                 In section .bss, align 1
   \                     ??ReadSta:
   \   00000000                      DS8 1

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4:
   \   00000000   0x40067000         DC32     0x40067000

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_1:
   \   00000000   0x400FF080         DC32     0x400ff080

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_2:
   \   00000000   0x........         DC32     MS5611_data_struct

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_3:
   \   00000000   0x40067002         DC32     0x40067002

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_4:
   \   00000000   0x42C80000         DC32     0x42c80000

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_5:
   \   00000000   0x00018BD5         DC32     0x18bd5

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_6:
   \   00000000   0x4118617C         DC32     0x4118617c

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_7:
   \   00000000   0x........         DC32     ??ReadSta

   \                                 In section .rodata, align 4
   \   00000000   0x00000000         DC32 0H
   \   00000004   0x00 0x00          DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x00 0x00    

   \                                 In section .rodata, align 4
   \   00000000   0x00000000         DC32 0H
   \   00000004   0x00 0x00          DC8 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x00 0x00    
   \              0x00 0x00    

   \                                 In section .rodata, align 2
   \   00000000   0x00 0x00          DC8 0, 0

   \                                 In section .rodata, align 4
   \   00000000   0x00 0x00          DC8 0, 0, 0, 0
   \              0x00 0x00    
    213          /*=====================================================================================================*/
    214          /*=====================================================================================================*/
    215          
    216          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       64  InitMS5611
             48 -> LPLD_GPIO_Init
             48 -> LPLD_I2C_Init
             48 -> MS5611_Calculate
             48 -> MS5611_ConvADC
             48 -> MS5611_ReadADC
             48 -> MS5611_ReadROM
             48 -> MS5611_WriteCommand
             48 -> PinNum2GpioPin
             48 -> __aeabi_memclr4
             64 -> __aeabi_memcpy4
             48 -> delayms
       28  MS5611_Calculate
             28 -> __aeabi_fdiv
             28 -> __aeabi_fmul
             28 -> __aeabi_i2f
             28 -> __aeabi_ldivmod
        8  MS5611_ConvADC
              8 -> MS5611_WriteCommand
       16  MS5611_MultiRead
             16 -> LPLD_I2C_ReadByte
             16 -> LPLD_I2C_SetMasterWR
             16 -> LPLD_I2C_Start
             16 -> LPLD_I2C_Stop
             16 -> LPLD_I2C_WaitAck
             16 -> LPLD_I2C_WriteByte
             16 -> delayus
       16  MS5611_Read
             16 -> MS5611_Calculate
             16 -> MS5611_ConvADC
             16 -> MS5611_ReadADC
       16  MS5611_ReadADC
             16 -> MS5611_MultiRead
             16 -> MS5611_WriteCommand
       16  MS5611_ReadROM
             16 -> MS5611_ReadROM_1
       16  MS5611_ReadROM_1
             16 -> MS5611_MultiRead
             16 -> MS5611_WriteCommand
        8  MS5611_WriteCommand
              8 -> LPLD_I2C_Start
              8 -> LPLD_I2C_Stop
              8 -> LPLD_I2C_WaitAck
              8 -> LPLD_I2C_WriteByte
              8 -> delayus


   Section sizes:

   Bytes  Function/Label
   -----  --------------
      20  ?<Constant {(GPIO_Type *)0}>
      16  ?<Constant {(I2C_Type *)0}>
       2  ?<Constant {0, 0}>
       4  ?<Constant {0}>
       4  ??DataTable4
       4  ??DataTable4_1
       4  ??DataTable4_2
       4  ??DataTable4_3
       4  ??DataTable4_4
       4  ??DataTable4_5
       4  ??DataTable4_6
       4  ??DataTable4_7
     182  InitMS5611
     246  MS5611_Calculate
      14  MS5611_ConvADC
     144  MS5611_MultiRead
     106  MS5611_Read
      56  MS5611_ReadADC
      38  MS5611_ReadROM
      54  MS5611_ReadROM_1
      58  MS5611_WriteCommand
      80  MS5611_data_struct
       1  ReadSta

 
  81 bytes in section .bss
  42 bytes in section .rodata
 930 bytes in section .text
 
 930 bytes of CODE  memory
  42 bytes of CONST memory
  81 bytes of DATA  memory

Errors: none
Warnings: none
